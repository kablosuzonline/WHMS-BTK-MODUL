whmcs btkreports modül kod geliştirme projesine başlamadan önce mevcut sistem altyapısı hakkında bilgi vermek istiyorum;
sistem pleks linux PHP Version 8.1.32 üzerinde çalışan WHMCS 8.13.0-release.1 version. Proje ekleri arasında Sunucunun phpye ait teknik dokumanıda mevcut.
WHMCS sistemine ilişkin konfigürasyon ayarları hakkında bilmen gerek bir konuda config.php satırları arasında yer alan

$customadminpath = 'yonet';  ile WHMCS admin URL adresi belirleniyor.

Projeye ait kod veya resimlerde bu "URL ADRES" bilgisine iyitaç duyabilirsin.

Teknik altyapıdan sonra bizi biraz tanımanı isterim. böylece hedeflerimizi daha iyi analiz edebilirsin.

Şirket Olarak Bilgi Teknolojileri ve İletişim kurumu tarafından İSS ve AİH konularında yetkilendirilmiş olarak iletişim faaliyeti yürüten bir işletmeyiz.
Abonelerimize verdiğimiz hizmetleri ve politikalarımızı tanımak ve anlamak için aşağıda linklerini paylaştığım WHMCS tabanlı kurumsal web sayfamızı da incelemeni istiyorum. 

https://wwww.kablosuzonline.com.tr/wisp/
https://www.kablosuzonline.com.tr/wisp/kurumsal-bilgilerimiz
https://www.kablosuzonline.com.tr/wisp/knowledgebase



Bu modül resmi bir Devlet kurumu olan BTK trafından yetkilendirilmiş olduğumuz konularda sunduğumuz hizmetlere İlişkin; "ABONE REHBER", "ABONE HAREKET" ve "PERSONEL BİLGİLERİNE"  verilerin, yine BTK tarafından sağlanan TEKNİK DÖKÜMANDA (314_KK_Abone_Desen.pdf) istenildiği şekilde göndermek üzerine olduğu için aşağıda linklerini verdiğim adreslerden tüm ilgili mevzuatlar öğrenmeni istiyorum.

https://www.btk.gov.tr/kanunlar

https://www.btk.gov.tr/bakanlar-kurulu-kararlari

https://www.btk.gov.tr/yonetmelikler

https://www.btk.gov.tr/tebligler

https://www.btk.gov.tr/kurul-kararlari (özellikle ceza ve idari yaptırım kararlarını iyi öğrenmelisin ki bizde aynı hatalara düşmeyeleyim)







Öncelikle benimle konuşurken ve modülü yazarken türkçe ile tam uyumlu olmanı istiyorum.
Bu projenin hiç bir aşamasında bana manuel iş yükleme zaman kaybettirme.. her türlü düzeltme derleme işlemlerini senin yapmanı ve bana dosyanın en son düzenlenmiş halinin bütününü eksiksiz olarak vermeni istiyorum.

sana modüle dait bir teknik dokuman (314_KK_Abone_Desen.pdf) gönderiyorum.

btk kurumunun istediğini verileri whmcs üzerinden çekip istenilen dosyaları istenilen zamanda ve istenilen şekilde gönderilmesini sağlayacak bir modül yazmanı istiyorum.

Bu modülün nasıl görünmesine dair (ANASAYFA ve CONFIG Sayfalarına dair) görsel TEMA tasarımlarını ekte gönderdim. temalara ilişkin tpl kodlamalarında bu örnek iki TEMA TASARIMINI kullanarak diğer ekranları da bu şekilde dizayn etmeni istiyorum.


whmcs modül kurulumu esnasında (modülün yönetim bölümünde güncellenebilmesi de sağlanacak şekilde) btk tarafından hangi konularda yetkilendirilmiş olduğunu seçimi sağlanmalı birden çok kutucuk işaretlenmesine olanak sağlanmalı ve seçilen her faaliyet alanına dair istenen verilere ilişkin ayrı ayrı dosyaların oluşması sağlanılmalı.



BTK YETKİ TÜRLERİ DE ŞU ŞEKİLDEDİR.

Yetkilendirme Türü

Altyapı İşletmeciliği Hizmeti (B)

Altyapı İşletmeciliği Hizmeti (K)

GMPCS Mobil Telefon Hizmeti (B)

GMPCS Mobil Telefon Hizmeti (K)

GSM (İmtiyaz Sözleşmesi)

Hava Taşıtlarında GSM 1800 Mobil Telefon Hizmeti (B)

IMT (Sayısı Sınırlandırılmış Kullanım Hakkı Yetki Belgesi)

IMT-2000/UMTS (İmtiyaz Sözleşmesi)

Kablolu Yayın Hizmeti (B)

Ortak Kullanimli Telsiz Hizmeti (K)

Rehberlik Hizmeti (K)

Sabit Telefon Hizmeti (B)

Sabit Telefon Hizmeti (K)

Sanal Mobil Şebeke Hizmeti (B)

Sanal Mobil Şebeke Hizmeti (K)

Uydu Haberleşme Hizmeti (B)

Uydu Platform Hizmeti (B)

Uydu ve Kablo TV Hizmetleri

Çeşitli Telekomünikasyon Hizmetleri (İmtiyaz Sözleşmesi)

İnternet Servis Sağlayıcılığı (B)



Yetki Türlerindeki (B) Yetkinin Bildirim Kapsamında Olduğunu, (K) ise Yetkinin Kullanım Kapsamında Olduğunu ifade etmektedir.



Ayrıca whmcs modül kurulumu esnasında (modülün yönetim bölümünde güncellenebilmesi de sağlanacak şekilde) btk tarafından bildirilen "OPERATÖR KODU" ve "OPERATÖR ADI" ve dosyaların gönderileceği ftp sunucusuna ait bilgilerin ve hangi dosyanın hangi ftp klasörüne yükleneceğine ilişkin tanımların yapılmasını istiyorum.
Config Ekranı sayesinde İlgili Dosyaların gönderilmesi için belirlenene FTP Sunucuyu Belirli Aralıklarla (5 Dakikada bir gibi) Yoklayıp Erişilebilir olup olmadığını kontrol edelim ve Sunucuya Erişim Var İse (Yeşil Renk ile) AKTİF, Şayet Sunucuya Erişim Sağlanamadı ise (Kırmızı Renk ile) PASİF şeklinde modül ana sayfasında info görünsün istiyorum.
Bunlara ilave olarak Modüle İlişkin sürüm güncellemelerine ilişkin zaten hazırladığımız (README.MD gibi) Bir TXT Döküman Hazırlansın ve O dokümana Erişim için Ana Sayfada Link Sağlansın. 
 


Böyle Bir Modülüne ihtiyaç Duymamızın en büyük nedeni BTK tarafından sağlanan TEKNİK Dökümandaki verilerin, WHMCS tarafından karşılanamıyor olması bir çok alan WHMCS'de bulunmuyor bulunanlarda yetersiz kalıyor.

Bu eksiklikleri Customfields üzerinden karşılama düşüncesini daha önceki incelemelerimizde özellikle ürün/hizmet bilgileri kısmında her bir hizmet için ayrı ayrı product fields oluşturmak gerektiği Customfields yapısının Value ve field yapısının iki ayrı tablo ile yönetildiği görüldü bu hem büyük bir veritabanı karmaşasası hemde verinin doğruluk ve bütünlüğünü sağlamanın zorlaşacağına karar verdik. Ayrıca Abone veya Hizmetlere ilişkin Hareketlerin kancalar yardımı ile Customfieldsleri tetikleyemecek olduğunu fark edince

modülün ihtiyaç duyduğu veriler için modulun kendine ait sql tablolarının olmasına karar verdik.



whmcs modül kurulumu esnasında whmcs'de olmayan bu veri alanların teknik dokumanın istediği verileri karşılayacak şekilde oluşturmasını sağlayalım.

yapıtığımız çalışmada ilgili alanların whmcs ile eşleşenlerini de şu şekildedir;



BTK'DAN İSTENEN:	OPERATOR_KOD	MUSTERI_ID	HAT_NO	HAT_DURUM	HAT_DURUM_KODU	HAT_ACIKLAMA	MUSTERI_HAREKET_KODU	MUSTERI_HAREKET_ACIKLAMA	MUSTERI_HAREKET_ZAMANI	HIZMET_TIPI	MUSTERI_TIPI	ABONE_BASLANGIC	ABONE_BITIS	ABONE_ADI	ABONE_SOYADI	ABONE_TC_KIMLIK_NO	ABONE_PASAPORT_NO	ABONE_UNVAN	ABONE_VERGI_NUMARASI	ABONE_MERSIS_NUMARASI	ABONE_CINSIYET	ABONE_UYRUK	ABONE_BABA_ADI	ABONE_ANA_ADI	ABONE_ANNE_KIZLIK_SOYADI	ABONE_DOGUM_YERI	ABONE_DOGUM_TARIHI	ABONE_MESLEK	ABONE_TARIFE	ABONE_KIMLIK_CILT_NO	ABONE_KIMLIK_KUTUK_NO	ABONE_KIMLIK_SAYFA_NO	ABONE_KIMLIK_IL	ABONE_KIMLIK_ILCE	ABONE_KIMLIK_MAHALLE_KOY	ABONE_KIMLIK_TIPI	ABONE_KIMLIK_SERİ_NO	ABONE_KIMLIK_VERILDIGI_YER	ABONE_KIMLIK_VERILDIGI_TARIH	ABONE_KIMLIK_AIDIYETI	ABONE_ADRES_TESIS_IL	ABONE_ADRES_TESIS_ILCE	ABONE_ADRES_TESIS_MAHALLE	ABONE_ADRES_TESIS_CADDE	ABONE_ADRES_TESIS_DIS_KAPI_NO	ABONE_ADRES_TESIS_IC_KAPI_NO	ABONE_ADRES_TESIS_POSTA_KODU	ABONE_ADRES_TESIS_ADRES_KODU	ABONE_ADRES_IRTIBAT_TEL_NO_1	ABONE_ADRES_IRTIBAT_TEL_NO_2	ABONE_ADRES_E_MAIL	ABONE_ADRES_YERLESIM_IL	ABONE_ADRES_YERLESIM_ILCE	ABONE_ADRES_YERLESIM_MAHALLE	ABONE_ADRES_YERLESIM_CADDE	ABONE_ADRES_YERLESIM_DIS_KAPI_NO	ABONE_ADRES_YERLESIM_IC_KAPI_NO	ABONE_ADRES_YERLESİM_NO:	KURUM_YETKILI_ADI	KURUM_YETKILI_SOYADI	KURUM_YETKILI_TCKIMLIK_NO	KURUM_YETKILI_TELEFON	KURUM_ADRES	AKTIVASYON_BAYI_ADI	AKTIVASYON_BAYI_ADRESI	AKTIVASYON_KULLANICI	GUNCELLEYEN_BAYI_ADI	GUNCELLEYEN_BAYI_ADRESI	GUNCELLEYEN_KULLANICI	STATIK_IP	ISS_HIZ_PROFILI	ISS_KULLANICI_ADI	ISS_POP_BILGISI

WHMCS DE VAR OLAN:		tblclients.id	tblhosting.id						WHMCS'DE MÜŞTERİ VE/VEYA ÜRÜNLERE İLİŞKİN HER TÜRLÜ GÜNCELLEMENİN ZAMANI			tblhosting.regdate		tblclients.firstname	tblclients.lastname			tblclients.companyname	tblclients.tax_id																														tblclients.phonenumber		tblclients.email	tblclients.city	tblclients.state																	tblhosting.dedicatedip		tblhosting.username	tblhosting.server 





sana ayrıca yarım kalan projeye ait yazılımı tamamlanan kodları da göndereceğim.

Aslında çalışmada büyük bir yol aldık :)

----------------------------------------





Teknik dökümanda istenen verilerin oluşturulması esnasında; whmcs modülüne ait veritabanı alanlarından "TC.KİMLİK NO" ve "YABANCI KİMLİK NO" alanlara verişi girişi esnasında verilerin Türkiye Cumhuriyeti Devleti, Nüfus ve Vatandaşlık İşleri Genel Müdürlüğü

https://tckimlik.nvi.gov.tr üzerinden doğrulamasını sağlayacak bir api ilave etmeni istiyorum. veri girişi yapıldıktan sonra ikinci bir veri alanına geçerken veya enson verileri kayıt etme aşamasında bu doğrulama yapılabilir hangisi doğru ise onu tercih edebilirsin.

yapılacak bu doğrulama aşamasında api'nin ihtiyaç duyucağı verilerin, TEKNİK DÖKÜMANDA İSTENEN VERİLER ARASINDA OLMASI işimizi kolaylaştıracaktır. 

bu konuda araştırma yap ve en doğru yöntemle doğrulamayı gerçekleştir. hatalı bir sonuç döner ise yanış olan "TC.KİMLİK NO" ve/veya "YABANCI KİMLİK NO" bilgilerini ekranda göster ve bu yanlış verilerin whmcs modülüne ait tablolarına yazılmasına izin verme. Ayrıca Bu doğrulama işlemi teknik veri dosya(larını) oluşturma aşamasında gerçekleşmesini sağlamalısın. Hatalı olan doğrulanmamış olan "TC.KİMLİK NO" ve/veya "YABANCI KİMLİK NO" düzeltilmesi gerektiğinine dair uyarı mesajını ekranda göster ve modülün log klosöründe hataları "TC.KİMLİK NO" ve/veya "YABANCI KİMLİK NO" bilgilerini dair log dosyası oluştur.



Türkiye Cumhuriyeti Vatandaşları için : https://tckimlik.nvi.gov.tr/service/kpspublic.asmx?op=TCKimlikNoDogrula



YABANCILAR için: https://tckimlik.nvi.gov.tr/service/kpspublicyabancidogrula.asmx?op=YabanciKimlikNoDogrula





ÖRNEK BTK Abone verisi:



701|;|1000001|;|1343|;|A|;|1|;|AKTIF|;|1|;|HAT DURUM DEGISIKLIGI|;|20240517030741|;|WIFI|;|G-SIRKET|;|20160824080000|;|00000000000000|;|TAMER|;|GENÇEL|;||;||;||;|32479043158|;||;|E|;||;||;||;||;||;|0000-00-00|;||;|ONODEMELI|;|0|;|0|;|0|;||;||;||;||;||;||;|0000-00-00|;|B|;|BALIKESİR|;|AYVALIK|;|KÜÇÜKKÖY MAHALLESİ ATATÜRK BUL. AZEMBEY SOK.|;|AZİM APT. NO:6 D:2 (1031832817)|;||;||;|10410|;|0|;|+90.542 615 61 88|;||;|tamer.gencel@kablosuzonline.com.tr|;|BALIKESİR|;|AYVALIK|;|KÜÇÜKKÖY MAHALLESİ ATATÜRK BUL. AZEMBEY SOK.|;|AZİM APT. NO:6 D:2 (1031832817)|;||;||;|0|;|TAMER|;|GENÇEL|;|0|;|+90.542 615 61 88|;|KÜÇÜKKÖY MAHALLESİ ATATÜRK BUL. AZEMBEY SOK. AZİM APT. NO:6 D:2 (1031832817) AYVALIK BALIKESİR|;||;||;||;||;||;||;|192.168.1.258|;||;|32479043158|;|2\n



---------------------------------------------



bir önemli husus daha var, Tüm Adres Bilgilerinin (İL, İLÇE, MAHALLE, SOKAK/CADDE/BULVAR, BİNA ADI, DIŞ KAPI NO, İÇ KAPI NO, ADRES KODU, POSTA KODU gibi ) tüm adres bilgilerinin ister YERLEŞİM, ister TESİS, ister ise KURUM YETKİLİSİNE ait olsun tüm adreslerin doğruluğunu ve bütünlüğünü sağlamak için BTK tarafından nvi adres doğrulama istenmektedir. Ancak NVİ ile yapılan tüm görüşmelerde KPS sistemine dair taleplerimiz kabul edilmedi.



-----------------------------------------------



Doğrulama yapamadığımız için Modül içindeki Tüm Adres Bilgilerinin (İL, İLÇE, MAHALLE, SOKAK/CADDE/BULVAR, BİNA ADI, DIŞ KAPI NO, İÇ KAPI NO, POSTA KODU gibi ) Bilgilerin Sisteme girişinde oluşacak insan ve kalavye hatalarının önünde geçebilmek ve veri girişini hızlanladırabilmek için Seçmeli Drop Menüler ile (İL Seçilince, O İL'in İLÇELERİ, İLÇELER arasından yapılacak seçimle o ilçeye ait Mahalleler, Mahalle Seçilince, O Mahalleye ait Cadde/Sokak/Bulvar, Cadde/Sokak/Bulvar seçildiğinde BİNA ADI veya BİNA NO, Bina adı veya Bina  No Seçildiğinde ise DAİRE NO) bilgilerinin bir drop menü araclığı ile ekrana getirilmesi sağlamalısın. böylece personel ve klavye giriş hataları  ortadan kaldırılır. daha önce bu verilerin java üzerinde mi yoksa veritabanında mı tutmak konusunda yaptığımız tartışmada veritabanında tutulmasının daha doğru olacağına karar verdik.





Adreslere ilişkin bir diğer önemli hususta evet whmcs müşteri bölümünde adres girilebiliyor ancak bu adresler hem btk'nın istediği gibi İL, İLÇE, MAHALLE, SOKAK/CADDE/BULVAR , BİNA ADI, DIŞ KAPI NO, İÇ KAPI NO, POSTA KODU , ADRES KODU gibi adres bilgilerini ve btk'nın talep ettiği aboneye ait kimlik bilgilerini gibi bir çok spesifik veriyi içermiyor. ayrıca en büyük eksikliklerden birisi de evet yetersizde olsa aboneye ilişkin bir adres var ve hatta birden çok kontak bilgisi de ilave edilebiliyor ancak, bazen bir müşteri birden çok adreste hizmet alabiliyor örneğin aynı abone  evinde, iş yerinde, merkezinde, şubesinde, fabrikasında, ofisinde bir den çok hizmete farklı farklı adreslerde ürün ve hizmetleri olabiliyor btk bunların hepsinin her bir ürün için TESİS ADRESİ olarak detaylandırılması isteniyor özetle btk abone değil aktif pasif tüm ürünlerin raporlanmasını istemektedir.

BTK Teknik Dosyasında Raporlanması istenen Abone YERLEŞİM(İkamet) Adresi Whmcs yönetim panelindeki "clients profile" bölümden girişi sağlanmalı.

Aboneye Hizmet ve Ürün Satışı Esnasında veya Sonrasında (clients services" bölümünde olabilir) YERLEŞİM ve HİZMET TESİS Adresi Aynı olup olmadığı sorulsun (seçim kutucuğu konulabilir).

Şayet Yerleşim ve Hizmet Tesis adresi aynı ise Yerleşim adresindeki verilerin otomatik olarak TESİS ADRESİ "clients services" bölümüne de işlenmesi sağlansın. BTK aynı bile olsa bu iki adresinde girilmesini istiyor.

Ayrıca Aboneye ait bile olsa Her bir ürün/hizmet için ayrı ayrı "tesis adresi" whmcsdeki "clients services" bölümünden girilmesi sağlanmalı.

Modülün ana konusu olan BTK Rapor(ları) için gerekli olmasa da ek olarak abonenin internet erişim hizmetine ilşkin bakım ve onarım için giden teknik ekibin tesis adresini google map üzerinden konum bilgisi alanı da eklensin. Böylece Teknik ekip direk konuma gideceği için daha hızlı ulaşım sağlayacaktır.


--------------------------------------------

WHMCS'nin mevcut yapısının bazı sınırlamaları olduğunu ve iş gereksinimlerinizi tam olarak karşılamamıyor.





Özetle, sorun şu:



WHMCS, müşterilerin fatura adreslerini yönetmek için iyi bir sistem sunuyor.

Ancak, hizmetlerin sunulduğu adresler (tesis adresleri) her zaman fatura adresleriyle aynı olmayabiliyor.

Bir müşterinin birden fazla hizmeti farklı adreslerde olabilir (ev, iş yeri, şube vb.).

WHMCS'nin mevcut yapısı, tesis adreslerini hizmetlerle ilişkilendirme konusunda yetersiz kalıyor.

Çözüm Önerisi: clientsservices'e Adres Alanları Eklemek



Bu sorunu çözmek için, "clients services" ekranına adres alanları eklemek mantıklı bir çözüm gibi görünüyor. Bu, her bir hizmet kaydına özel bir adres atamanızı sağlayacaktır.





-------------------------------------------------



yine aynı teknik dokümanda dosyaların ftp sunucuna yüklenilmesinden bahsediliyor. her bir işletmecinin kendi ftp sunucusu olduğu için burada teknik dokumanda genel bir ifade kullanılmıştır. bu ftp sunuculara ilişkin bilgiler ve oluşturulacak olan her bir dosyanın yükleneceği klasörler farklıdır. ve süreç içinde bu klasörlerin değiştirildiğini göz önüne alınır ise bu ftp sunucusuna ait erişim bilgileri ve yüklenecek dosyaların hedef yollarını da kod içine gömmek yerine modül ilk kurulurken bu bilgilerin girilmesini ve ilerde oluşacak bir değişik söz konusu olduğunda bu bilgilerin yönetim ara yüzünden güncellenmesini sağlamak daha doğru olacaktır.



--------------------------------------------------





modülün tüm kurulum ve yönetim aşamasının güncellenebilen esnek bir yapıya sahip olsun istiyorum.





hooks demişken BTK'nın üzerinde durduğu hassasiyet gösterdiği konulardan birisi da istediğini verilerden birisi bile değişse veya hareket görse HAREKET dosyasına anında yansımasını istiyor bu yüzden kancalar çok önemli :) ayrıca BTK TEKNİK DOKUMANINI detaylı incelersen REHBER dosyaları  Aktif/Pasif/İptal durumu ne olursa olsun tüm Geçmiş veya Mevcut Abone Bilgilerini her ay belirtilen gün ve saatte gönderilmesi gerekiyor.

Diğer HAREKET Dosyası ise Her gün Belirtilen Saatte Bir Önceki gündeki gönderim zamanından bu yana biriken hareketlerin gönderilmesini istiyor.

yani FTP sunucuna bırakılan bir HAREKET diğer günün hareket dosyasında olmaması gerekiyor bu da demek oluyor ki;

REHBER Dosyasında oluşan hiç bir kayıt silinemez ancak güncellenebilir (gerekiyorsa silme korumalı yapılabilir Aboneye Ait Bazı Bilgiler ASLA Değiştirilemez TC. Kimlik No, Ad, Soyad gibi)

Ancak Gönderilmiş olan HAREKET dosyası içinde yer alan veri (şayet veri tabanında tutuluyor ise) HAREKET.ABN.GZ dosyasına yazıldığı an veritabanından silinmeli ki mükerret hareket kaydı oluşmasın.





BTK YETKİLENDİRME TÜRLERİNİ çok iyi anlamanı istiyorum. hassas bir konu Bir işletmeci Birden çok YETKİLENDİRME TÜRÜNE Sahip olabilir.  Ürünlerin/hizmetlerin hangi YETKİ TÜRÜNE haiz olduğunu her ürün veya ürün gurubu için belirlenmeli ve o yetki türüne ait gönderim şekline ve dosya formatına gönderilmeli. Diyelim ki bir işletmeci Hem ISS hemde AİH yetki türüne sahip ama sadece İSS abonesi ve hizmeti sunmuş. BTK zaman zaman karar değişikliğine gidip boşta olsa eğer o türe ait yetkilendirilmiş isen boş bile olsa o dosyayı FTP yükleyeceksin diyebilmektedir. yönetim ekranında abone/hizmet olmasada boş veri gönder diye bir kutucuk konulmasında fayda var ne dersin?





bu konu biraz karışık sana şöyle özetliyeyim bir İnternet Servis Sağlama işini, Nihai son kullanıcıya sunar isen bu İSS yetkisi kapsamında değerlendiriliyor, ancak aynı ürünü yine sizin gibi BTK tarafından yetkilendirilmiş bir başkaca işletmeciye bu hizmeti sunuyor iseniz ve o hizmet üzerinden o işletmeci kendi abonelerine hizmet veriyor ise yani sizden alıp başkasına satıyor ise o zaman BTK sizin o hizmet AİH (altyapı İşletmeciliği Hizmeti) kapsamında değerlendiriyor. yani ürünün veya hizmetin ne olduğu kadar.. abonenin de kim olduğu etken... bu konuyu da öğrendiğine göre önerilerini tekrar dinlemek isterim.







ayrıca sana modülün şu ana kadar ki gelinen noktasını gösteren modul-durum-raporu.pdf raporunu göndereceğim ve yazdığımız kodların son hallerini de oradan devam edelim.



senden WHMCS 8.13.0-release.1 versionunu ve PHP Version 8.1.32 desteği olan (konumuzun dışında bile olsa) tüm whmcs kancalarını öğrenmeni istiyorum.

Ayrıca birazdan bir whmcs-whatsapp Modülüne ait dosyaları da göndereceğim. lütfen onları da incele bizim projeye yakın bir modül. bu modül hook yardımı ile hertürlü müşteri ve ürün değişikliğini aynı anda whatsapp mesajlarını anlık olarak gönderiyor.




-------------------------------------------



BTK tarafından alınan ilgili bir karar ile Her yılın 6. Ve 12. Aylarının sonuna kadar (EK'teki excel örneğindeki bilgileri içerecek şekilde) Mevcut Personel bilgilerin iletilmemesi durumunda ilgili mevzuat hükümleri uyarınca BTK Kurumu tarafından idari yaptırım uygulama yoluna gitme hakkına haiz bulunduğu bilgisine ulaştık.
Bu kez dosya ekteki örnek excel dosya şeklinde yine aynı ftp adresine ancak farklı bir klasöre bırakılması gerekiyor. config ekranından zaten ftp sunucu bilgileri giriş ekranı mevcut idi.. "ABONE HAREKET" Ftp dosya yolunun olduğu giriş alanının hemen altına (CONGIG TEMA TASARIM RESMİNDE OLDUĞU GİBİ) persenel listesini içeren EXCEL dosyasının hangi ftp klasörüne gönderileceğine dair bir giriş alanı olsun.
Personel listesini ve bilgilerin bir bölümü whmc yöneticiler (configadmins) bölümündeki (excelldeki taleplerle eşleşenleri) verileri oradan çekeceğiz. Ancak bu whmcs bölümü istenen tüm bilgileri kapsamıyor.
O nedenle mod_btk_personel adlı oluşturulacak sql tablosuna ihtiyaç duyacağız.

Bu SQL TABLO (mod_btk_personel) Modül İnstall Aşamasında iken oluşturulması sağlanacak.
modül kuruluş aşamasında iken ilk anda zaten whmcs yöneticiler "configadmins" bölümünden ("tbladmins" SQL TABLOSUNDA TUTULUYOR) var olan ve eşleşen alanların "mod_btk_personel" sql tablosuna yazılması sağlansın.
Ayrıca ilerdeki süreçte whmcs yöneticiler "configadmins" bölümüne eklenen her yeni personel (hooks) kancalar yardımı ile anlık olarak bu tabloya da yazılması sağlansın.

BU SQL TABLOSUNDA AŞAĞIDAKİ ALANLARDAN OLUŞACAK;


personel_id (Modül henüz Kurulurken, whmcs yöneticiler "configadmins" bölümündeki mevcut tüm personel için modül tarafından "anahtarlama" (benzersiz) olacak şekilde otomatik oluşturulsun. ayrıca ilerdeki süreçte whmcs yöneticiler "configadmins" bölümüne eklenen her yeni personel (hooks) kancalar yardımı ile anlık olarak yeni personel bilgisi otomatik olarak oluşması sağlansın. whmcs üzerinden çekilecek veriler için kullanacağımız "tbladmins" Sql tablosunun "id" alanı ile "FOREIGN KEY" olarak tanımlanması sağlansın.)

Firma Adı (Modülün config Bölümündeki, "OPERATOR KODU" ve "OPERATOR ADI" bölümlerinin olduğu sql tablosuna ve config.tpl sayfasına "OPERATOR UNVANI" alanı da eklensin ve mod_btk_personel SQL tablosundaki her personel için oradan yazılsın. ancak bu alan hiç bir şekilde "ABONE REHBER" ve/veya "ABONE HAREKET" dosya içeriklerinde yer almayacak. Sadece PERSENOL ALANI için kullanılacaktır.)    

bu konudaki şu detayı bilmelisin "OPERATOR ADI" ile "OPERATOR ÜNVANI" aynı şey değil.. "OPERATOR ADI", BTK tarafından belirleniyor genelde şirket unvanlarının kısa isimlerinden oluşuyor türkçe karekter kıllanılmıyor ve buyuk harf ile yazılıyor ve karakterler arasında boşluk olmuyor bunların nedenini sende tahmin etmiş olmalısın.. OPERATOR ADI oluşturulacak olan dosyaların adını ilave geliyor.. örneğin bizim OPERATOR ADI : IZMARBILISIM


"OPERATÖR UNVANI" Şirketin Ticaret sicilinde tescilli resmi adıdır. Tescilde Nasıl yazılıyor ise hiç bir değişiklik yapılmadan aynen yazılır. Bizim Resmi Şirket Unvanımız: İZMAR BİLİŞİM HİZMETLERİ SANAYİ TİCARET LİMİTED ŞİRKETİ

"OPERATÖR UNVANI" Bu datayı sadece PERSONEL Listesi içeren EXCEL dosyasında kullanacağız. 



Adı (Modül henüz Kurulurken, whmcs yöneticiler "configadmins" bölümündeki mevcut tüm personele ait "tbladmins" Sql tablosunun "firstname" alanından alınsın, ayrıca ilerdeki süreçte whmcs yöneticiler "configadmins" bölümüne eklenen her yeni personel (hooks) kancalar yardımı ile anlık olarak yeni personel bilgisi otomatik olarak oluşması sağlansın.)

Soyadı (Modül henüz Kurulurken, whmcs yöneticiler "configadmins" bölümündeki mevcut tüm personele ait "tbladmins" Sql tablosunun "lastname" alanından alınsın, ayrıca ilerdeki süreçte whmcs yöneticiler "configadmins" bölümüne eklenen her yeni personel (hooks) kancalar yardımı ile anlık olarak yeni personel bilgisi otomatik olarak oluşması sağlansın.)

TC Kimlik No (Müşteri/Abone tarafında zaten doğrula olayını yapmıştık oradaki çalışma üzerinden bu "TC Kimlik No" alanındaki verilerde yine aynı metodla doğrulansın)

Ünvan (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

Çalıştığı birim (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

Mobil telefonu (alan koduyla birlikte 10 hane olarak giriniz), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

Sabit telefonu (alan koduyla birlikte 10 hane olarak giriniz), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

E-posta adresi (Modül henüz Kurulurken, whmcs yöneticiler "configadmins" bölümündeki mevcut tüm personele ait "tbladmins" Sql tablosunun "email" alanından alınsın, ayrıca ilerdeki süreçte whmcs yöneticiler "configadmins" bölümüne eklenen her yeni personel (hooks) kancalar yardımı ile anlık olarak yeni personel bilgisi otomatik olarak oluşması sağlansın.)

EV ADRESİ (Her ne kadar BTK EXEL tablosuna işlenecek veriler arasında yer almasa da modüle ilave edilmesini istiyorum. İleride bu modül "GÜNÜN BİRİNDE BTK BU BİLGİLERİN GÖNDERİMİNDEN VAZGEÇZE BİLE" Yazdığımız bunca kod boşa gitsin istemem, "PERSONEL İK" olarak geliştirebiliriz. İleri dönük olsun), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

ACİL DURUMDA ARANACAK KİŞİ VE İLETİŞİM BİLGİLERİ (Her ne kadar BTK EXEL tablosuna işlenecek veriler arasında yer almasa da modüle ilave edilmesini istiyorum. İleride bu modül "GÜNÜN BİRİNDE BTK BU BİLGİLERİN GÖNDERİMİNDEN VAZGEÇZE BİLE" Yazdığımız bunca kod boşa gitsin istemem, "PERSONEL İK" olarak geliştirebiliriz. İleri dönük olsun), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

İŞE BAŞLAMA TARİHİ (Her ne kadar BTK EXEL tablosuna işlenecek veriler arasında yer almasa da modüle ilave edilmesini istiyorum.), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

İŞTEN AYRILMA TARİHİ (Her ne kadar BTK EXEL tablosuna işlenecek veriler arasında yer almasa da modüle ilave edilmesini istiyorum. Zira BTK Excel Dosya Gönderme anında ki İŞ İLİŞİĞİ KESİLENLER HARİÇ, mevcut çalışanların listesini istiyor), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)
 
İŞ BIRAKMA NEDENİ (Her ne kadar BTK EXEL tablosuna işlenecek veriler arasında yer almasa da modüle ilave edilmesini istiyorum. İleride bu modül "GÜNÜN BİRİNDE BTK BU BİLGİLERİN GÖNDERİMİNDEN VAZGEÇZE BİLE" Yazdığımız bunca kod boşa gitsin istemem, "PERSONEL İK" olarak geliştirebiliriz. İleri dönük olsun), (Modül kurulur iken veya sonrasın whmcs yöneticiler "configadmins" bölümündeki bu bölüm olmadığı için bu bölüm boş olacaktır. Ancak personel.tpl ekranından ilgili alanın MANUEL olarak (boş ise) Girişine zorlansın. personel.tpl Ekranından Girilen verilerin kayıtetmesi için oluşturulan sektmeye butona basıldığında halen herhangi bir personelin Girilmeyen eksik bilgileri mevcut ise uyarı verilsin ve kayıt işlemini yapmasın.)

modülün personel yönetim ekranı olan personel.tp ekranında listenen tüm personelin son kısmında bir anahtarlama (seçim) olsun. (BTK LİSTESİNE EKLENSİN) Şeklinde çünkü personel bilgisini whmcs yöneticiler "configadmins" bölümünden çağıracağımız için orada aslında var olmayan ancak bazı entegrasyonlar için (Banka, Sanal Pos v.b. API Erişimleri için) oluşturulmuş hesaplar olabiliyor onların BTK Raporuna eklenmesi doğru olmaz.


Oluşturalacak excel dosyasının adı : Dosyanın adı diğer "ABONE REHBER" ve "ABONE HAREKET" Dosyalarından biraz farklı olacak dosyanın adında ("OPERATOR ADI"_Personel_Listesi_"DOSYA HAZIRLAN YILI"_"DOSYA HAZIRLAN AYI") Örneğin: IZMARBILISIM_Personel_Listesi_2024_6.xlsx Şeklinde Config.tpl'de belirtilen FTP SUNUCUNUN, personel.tpl'de Dosya Yolu belirtilen FTP Klasörüne excel (formatında) kayıt edilecek. 

Oluşturulma zamanları : Her yılın 6. Ve 12. Aylarının son günü saat 16:00

oluşturulan dosyanın içeriği: Dosyanın gönderim zamanında mevcut çalışan personelin listesi


Sana gönderdiğim modul-dosya-tree-yapısı.pdf dosyasını incelersen zaten sende fark edeceksin projenin iskelet yapısını zaten daha önceki seninle olan çalışmalarımızda bir yere kadar getirdik.. kaldığımız yerden devam edelim istiyorum.

Projenin ilerleyen aşamalarında Hatalı veya eksik bölümleri beraber geliştirelim. Örneğin Henüz whmcs Müşteri Panelinde giren Müşterilerin(Abonelerin), Kendisine Ait Bilgilerin "clientarea.php?action=details" ekranında görebileceği ama Hiç bir şekilde Değiştirme, Düzeltme veya Silme Yapamayacağı sayfaların kodlanması gerekiyor.  

Ayrıca projenin her aşamasında senin öngörü ve tavsiyelerine açığım. Her türlü katkın beni mutlu edecektir.

Ne Dersin devam edelim mi?

Konuyu en ince ayrıntısına kadar öğrenebilmen için "WHMCS_BTK_Modül_Geliştirme_Projesi_.docx" gibi bir çok dokumantasyon sağladım lütfen detaylı incele ve tüm enerjini bu projeyi tamamlamaya harca.

NOTLAR:
Dikkat edilmesi gereken bazı hususları aktarmak istiyorum. Whmcs Yazılım ekibi çok sık Altı ayda bir gibi sürekli yeni version üretiyorlar.
Çok sık olarak Whmcs kod ve sql tablo yapısının değiştiğini göz önüne alarak mümkün olduğunca whmcs'nin kendi yapısal bütünlüğünü etkilemekten kaçınmalısın. değilse ise WHMCS'nin çıkaracağı ilk yeni versionda modülümüz uyum sorunu yaşayabilir. 

Sana bazı talimatlarımı gönderdiğim resim dosyalarının içeriklerinden göreceksin:

MOdülün ANASAYFA Temasının Nasıl Olacağını "TemaAnaSayfa.png"
CONFIG SAYFASI Temasının Nasıl Olacağını "Tema-ConfigSayfa.png"
Modülün TEMA Genelinde neler yer alması gerektiğini, sekme ve seçim butonlarının nasıl olmasını istediğimi "WHMS-BTK-MODUL-SECENEK-BUTON-VE-DIGER-ISTEKLER.PNG"



Projenin her aşamasında proaktif rol almak istiyorum. Her saat başında projeye ait dosya içeriklerini benimle paylaşmanı istiyorum. KOntrolün bende olmasını istiyorum.
Lütfen Arka Planda Yaptığın veya Yapmayı Hedeflediğin en ufak ayrıntıyı bile kaçırmadan bana belirli aralıklar ile bana rapor vermeni istiyorum.
Senden belirli aralıklarla son durum raporu isterim... arka planda yaptığın çalışmalardan beni haberdar etmelisin. Sürecin her adımında beni bilgilendir.
Ayrıca Türkiye'yaşıyorum Kendini (Türkiye/İstanbul) Zamanına göre ayarla.
Ayrıca Proje Aşamasında Talimat ve ayrıntıları unutmaman için ilk talimatları ve proje detay bilgilerini "Gemini_Pro_Talimatlar.txt" Gemini Pro Klasörüne yükledim. unutursan hatırlarsın..



Özellikle dikkat etmen gereken hususları ifade etmek istiyorum;


BTK rehber dosyada durumu ne olursa olsun (aktif/pasif/ iptal/ dondurulmuş diye ayırmadan) tüm hizmetlerin raporlanmasını istiyor.
Bir abonenin (aynı adreste veya farklı bir adreste) birden fazla hizmeti olabilir. böyle bir durumda her bir hizmet içinn ayrı ayrı kayıt satırı açılacak.
BTK'ya gönderilecek olan "ABONE REHBER" ve "ABONE HAREKET" dosyalarındaki bilgilerin eksiksiz oluşturalabilmesi için (ABONEYE VE HİZMETE DAİR TÜM VERİLERİN GİRİLMESİNİN SONRASINDA... ) hizmete ilişkin "siparişi onayla" tuşuna basıldığı an sipariş onay kancasının tetiklemesi ile birlikte "ABONE REHBER, YENİ ABONE" ve "ABONE HAREKET, YENİ ABONE" olacak şekilde ilk kayıt(lar) oluşsun.
Böylece BTK'ya EKSİK BİLGİ gitmemiş olacaktır.


Raporların dosya isim yapısını çok iyi  anlamanı istiyorum.
ayrıca dosya isimleri ne örnekler şu şekildedir;

Her iki raporda da şayet dosyalar ilk defa gönderiliyor ise (CNT) 01 olacak ve Aynı içeriklere sahip rapor mükerrer olarak tekrar gönderilmesi istenirse bu çoğu zaman BTK tarafına eksik paket gitme durumunda isteniyor) eski dosyanın üzerine yazılmasının önüne geçmek için CNT her seferinde bir sayı artırılıyor.

IZMARBILISIM_701_ISS_ABONE_REHBER_20240520223100_01.abn ( Sıkıştırılmış hali: IZMARBILISIM_701_ISS_ABONE_REHBER_20240520223100_01.abn.gz )
IZMARBILISIM_701_ISS_ABONE_HAREKET_20240520223100_01.abn ( Sıkıştırılmış hali: IZMARBILISIM_701_ISS_ABONE_HAREKET_20240520223100_01.abn.gz )


IZMARBILISIM_701_ISS_ABONE_REHBER_20240520223100_02.abn (BTK tarafından herhangi bir nedenle Dosyanın tekrar gönderilmesi talep edildiğinde CNT (Count): iki haneli kod birer arttırılarak iletilir. böylece eski dosyanın üzerine yazılmasının önüne geçilmiş olur)

IZMARBILISIM_701_ISS_ABONE_REHBER_20240520223100_01.abn.gz (sıkıştırılmış hali)
IZMARBILISIM_701_ISS_ABONE_REHBER_20240520223100_02.abn.gz (sıkıştırılmış hali) (BTK tarafından herhangi bir nedenle Dosyanın tekrar gönderilmesi talep edildiğinde CNT (Count): iki haneli kod birer arttırılarak iletilir. böylece eski dosyanın üzerine yazılmasının önüne geçilmiş olur)




Bir başka önemli hususta geçmiş çalışmalarımızda "ABONE REHBER" ve "ABONE HAREKET" dosyalarının içerikleri ve dosya formatına ilişkin zaman zaman yanlış kararlar almış olmandır.. bunun nedeni bu konuda seni tam aydınlatamamış olmam olsa gerek.. BTK'nın raporlarda ki ODAK Noktasın İşletmeci tarafından "HİZMET(LER)"; Bir abonenin birden fazla hizmeti olabilir (aynı adreste bile olsa) Ev, İş, Yazlık, Kışlık, Merkez, Şube veya depo, hatta aile bireylerinden bir başkasının adresine bile kendi adın İSS hizmeti alabilir.. böyle bir durumda her bir hizmet için ayrı ayrı kayıtlar oluşturulacaktır. böyle bir durumda  zaten sipariş öncesinde WHMCS admin panelindeki "clients profile" sayfası üzerinden ihtiyaç duyulan verilerin girişini sağlanmış olduğundan Whmcs "orders add" Ürün/Hizmet Sipariş Ekranında "Yerleşke Adresi ile Tesis Adresi Aynı" seçim kutucuğu (bu kutucusuk defauld olarak seçili gelsin bunun nedeni ise abone potansiyeli genelde ev kullanıcılarından oluşuyor.) ilave edilsin ve siparişi gönder tuşuna basılması ile birlikte WHMCS "clients services" alanına hooks yardımı ile oluşturduğumuz alanlara otomatik yazsın. bu kutucuk işaretli olmaz isen siparişi gönder tuşuna bastıktan sonra (normalde sipariş onayına gider iken) WHMCS admin panelindeki "clients services" sayfası yönlenmesini sağlanacak.. ve ihtiyaç duyululan verilerin girişini sağlamak için Modülün service_details.tpl sayfasının enjekte edilmesi sağlanacak. son aşamada WHMCS admin "clients services" sayfasının alt kısmındaki "Değişiklikleri Kaydet" butonu ile gerekli bilgilerin "whmcs'nin ilgili alanlarına ve BTK Modülüne ait (SQL) alanlara kaydı sağlandıktan hemen sonra (bu aşamaya kadar sipariş onayında bekliyor olan hizmetler için) yine "clients services" ekranında ki "Değişiklikleri Kaydet" butonunu hemen yanına bu sefer "Siparişi onayla" tuşu otomatik gelsin..  şayet bu tuşu getirme kabiliyeti yok ise ilgili hizmetin (orders.php?action=view&id=xxx) sipariş onay ekranına gidilsin. Tüm bu aşamalara kadar BTK için gerekli Tüm "ABONE REHBER" ve "ABONE HAREKET" için ihtiyaç duyulan tüm verilerin Büyük bir kısmı MODÜLÜN SQL TABLOSUNDA, Bir Kısmı ise ilgili WHMCS SQL Tablolarında Oluşmuş olacaktır. "Siparişi Onayla" Tuşuna  basıldığı an  "ABONE REHBER" ve "ABONE HAREKET" dosyalarına (314_KK_Abone_Desen.pdf Teknik dokumanda ifade  edilen kurallara uygun bir şekilde) "YENI ABONELIK KAYDI" oluşturulur. burada dikkat edilecek husus Bir Aboneye veya Hizmete ait veriler daha önceden bir başkaca tablolara kayıt edilmeli  ki "ABONE REHBER" ve "ABONE HAREKET" dosya içerikleri  "siparişi onayla" tuşuna basılması ile oralardan çekilmeli ya temp bölümünde (ki bu veri kaybına yol açabilir diye düşünüyorum) en sağlıklısı "ABONE REHBER" ve "ABONE HAREKET" dosya içeriklerinin tamamını barındıran örneğin "mod_btk_abone_rehber.sql" ve "mod_btk_abone_hareket.sql" tablolarına anlık olarak işlensin. Modül içindeki BTK Abone Veri Raporlama sayfasından (generate.tpl) yapılan işlemlerde Mevcut hiç bir veriyi silmeden rapor oluşturma ve gönderme işlemleri yapılır iken verilerin içeriği ve daha önce (manuel veya cron ile) gönderilip gönderilmediği kontrol edilerek şayet aynı verileri içeren bir rapor daha önce oluşturulmuş, ftp klasörüne yüklenmiş ise (bunun içince bir sql tablo gerekebilir dosyaların adlarının ve ftpye yükleme tarihlerinin ve aynı içerikli dosyanın kaç sefer gönderildiğini bir tabloda tutmak gerekir) daha sonraki aynı içerikteki mükerrer dosyalar, ilk oluşan dosyaların ismi aynen alacak ancak aynı içerikteki dosyanın kaç sefer oluşturulduğu ve ftpye yüklendiğini bilgisi de bir sql tabloda tutulmalı ki 314_KK_Abone_Desen.pdf  Dosyanın tekrar gönderilmesi talep edildiğinde iki haneli kod birer arttırılarak iletilir. Talimatları doğrultusunda; CNT (Count) oluşturulsun." burada önemli husus içeriklerin aynı olması durumudur. içeriklerin farklı olması halinde yeni bir dosya ismi ile yeni bir dosya oluşturulur.

bu arada config bölümüne ftp bilgilerinin yer aldığı ekranın hemen alt kısmına hangi dosyanın hangi zaman aralıklarında ve hangi saatte ftp sunucuna yükleneceğine dair cron çalışma zamanlamasına ait bölüm eklesin.
"ABONE REHBER" dosyasının gönderim zamanı defauld olarak "her ayın ilk günü saat 10:00" ve "ABONE HAREKET" dosyasının gönderim zamanı defauld olarak "her gün saat 01:00" olmalı ancak BTK'dan gelecek yeni talimatlar dosyasında bu cronların zamanlamalarına ilişkin değişikliğin bir kod değişikliğine ihtiyaç duymadan ekrandan ilgili personel tarafından değişiklik yapılabilmeli.

"ABONE REHBER" tablosunda oluşan hiç bir verinin, hiç bir şekilde ( Abone sözleşmesi, veya iptali durumunda dahi) silinmesi söz konusu dahil olamaz.
Ayrıca Hizmet veya Ürünün İPTAL bilgisi girildiği an  "ABONE REHBER" dosyasına "IPTAL" işlemlerine dair son güncelleme yapılırken aynı anda ve "ABONE HAREKET" dosyası son kez "IPTAL" işlemine ilişkin satır oluşturulur.
Hakkında "IPTAL" İşlemi yapılan "ÜRÜN/HİZMETLERİN" WHMCS sistemi içindeki herhangi bölümde Hizmete dair bilgilerin değiştirimesine edilmesi engellenmeli.
Hakkında "IPTAL" İşlemi yapılan "ÜRÜN/HİZMETLERİN" WHMCS sistemi içindeki herhangi bölümde Hizmetin tekrar aktif edilmesi engellenmeli.
Ayrıca (Sonradan İPTAL edilmiş Bile olsa..)  ONAYLANMIŞ Hiç bir Hizmetin SİLİNMESİNE DE İZİN VERİLMEMELİDİR!

BTK'nın yetki iptal sebebi sayabileceği kadar önemli olan bu konularda hassasiyet göstermeni Bireysel Abonelerde "Abone Numarası, TCKN, Ad Soyad" Kurumsal Abonelerde ise "Abone Numarası, UNVAN, MERSİS NO" gibi değiştirilmesi hayatın doğal akışına aykırı olan verilerin hiç bir şekilde değiştirilmesine veya silinmesine izin verilmemelidir.
   
Nerede Kaldık :) "ABONE HAREKETLERİ" dosyası EVET her bir hareket için ayrı ayrı bir kayıt satırı oluşacak olsa da bazen özellikle geriye dönük hukuki süreçlerde "BORÇTAN KAPAMA veya IPTAL" gibi veya benzeri konularda mahkemelere dava ve delil konusu olacak bu raporlarda hayati derecede öneme sahip... EVET bu veriler FTP Sunucuna gönderiliyor ama "HER NE KADAR SUNUCUNUN MÜLKİYET HAKKI BİZE AİT BİLE OLSA.. HATTA FİZİKİ OLARAK KENDİ OFİSİMİZDE BARINDIRIYOR OLSAK BİLE.. SUNUCUNUN YÖNETİMİ BTK TEKNİK PERSONELİNE AİT" Bizler de sadedece O sunucunun belirli klasörlerine ilgili verileri yükleyebiliyoruz.. Sunucu içindeki bir ALGORİTMA İlgili Klasöre, İlgili Veri Doğru şekilde yüklendi mi önce onu analiz ediyor sonra sıkıştırılmış bile olsa ilgili verinin içeriğini satır satır kontrol ediyor örneğin AD, SOYAD ve TCKN uyumsuzluğu ve/veya NVİ ADRES KODU ile girilen Adres alanları doğrulanıyor mu diye içerik analizini de yaptıktan sonra şayet satırların herhangi bir hata ile karşılaşırsa bir hat log dosyası oluşturuyor şu abonenin TCKN'si doğrulanamadı gibi.. Hiç bir hata yok ise bu dosyayı sunucuda bizim erişimine hatta görmemize bile yetkimizin olmadığı başka bir klasöre otomatik olarak aktarılıyor.. artık o dosyaya bizim hiç bir şekilde erişimimiz kalmıyor. BTK RAPORLARI 5651 Sayılı katalog suçlarla mücadele kapsamında değerlendiriyor ancak bizimde hukuki süreçlerde geriye dönük bir şekilde bu verilerin zaman damgalı bir şekilde kayıt altında tutulması REHBER zaten hiç bir şekilde SİLİNMESİ SÖZ KONU BİLE OLAMAZ.. ama hareketlerin SQL veri tabanını şişireceği endişesi içerisindeyim. bu konuda senin önerin nedir?


btkreports_deactivate(): Modül devre dışı bırakıldığında çalışır SQL dosyaların silinip silinmeyeceğine ilişkin zaten config ekranında bir seçim kutucuğu var. aynı uygulama devam etsin.

Genel Ayarlar:
Operatör Kodu (Text, BTK Teknik ekibi tarafından sözlü olarak bildirilir)
Operatör Adı (Text, BTK Teknik ekibi tarafından sözlü olarak bildirilir) 

Bu bilgilerin sözlü olarak aktarıldığı ve geçmiş dönemlerde SİZİN OPERATÖR ADINI IZMAR değil IZMARBILISIM olacaktı gibi olayların da yaşandığı düşünecek olursa sabit readonly olmasındansa config ekranından yönetilebilir olması daha doğru olacaktır.
Hiç bir aksilik olmasa bile işletmemiz zaman içinde belki de Ticari UNVANINI Değiştirme cihetine gidebilir böyle bir olayda OPERATÖR KODU VE OPERATÖR ADI da değişmesi sözkonusu olacaktır.
Ve modülümüzün ESNEK GELİŞİME AÇIK OLMA İlkelesine de ters düşecektir.

ANCAK DEĞİŞTİRELEMEZ BİLGİLER OLARAK READONLY OLABİLECEK VERİLERDE VAR ÖZELLİKLE BİREYSEL VEYA KURUMSAL ABONE Bilgilerindeki değiştirilmesi doğanın akışına ters olan doğumdam ölüme değişmesi mümkün olmayan veriler için söz konusu olsun 



bana projeye ait tüm dosyaların  fonksiyonlarının ve bana gönderilip gönderilmediğini belirten bir yapıya sahip tree yapısı istiyorum

